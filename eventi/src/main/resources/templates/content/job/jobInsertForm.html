<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/default_layout}">



<div layout:fragment="content">
<style>
.label{
color: black;
}

</style>

<section class="module bg-dark-60 gallery-page-header parallax-bg" data-background="assets/images/gallery_bg.jpg" style="background-image: url(&quot;assets/images/gallery_bg.jpg&quot;);">
          <div class="container">
            <div class="row">
              <div class="col-sm-6 col-sm-offset-3">
                <h2 class="module-title font-alt">게시글 등록 </h2>
                <div class="module-subtitle font-serif">Small Title</div>
              </div>
            </div>
          </div>
        </section>

	<div class="row no-gutters">
		<div class="col-md-7">
			<div class="contact-wrap w-100 p-md-5 p-4">
				<h3 class="mb-4">구인게시글 작성</h3>
				<form action="/jobInsert" method="POST" id="jobInsert" name="jobInsert"
					class="contactForm" enctype="multipart/form-data"> <!-- 파일 -->
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
					<div class="row">
						<div class="col-md-12">
							<div class="form-group">
								<label class="label" for="ttl">제목</label> 
									<input type="text" class="form-control" name="title" id="title" >
							</div>
						</div>

						<div class="col-md-12">
							<div class="form-group">
								<label class="label" for="#">내용</label>
								<textarea name="jobCntn" class="form-control" id="jobCntn" cols="30" rows="4"></textarea>
							</div>
						</div>
						
						<div class="col-md-12">
							<div class="form-group">
								<label class="label" for="#">수당</label>
								<input type="number" class="form-control" name="pay" id="pay" >
							</div>
						</div>
						
						<div class="col-md-12">
							<div class="form-group">
								<label class="label" for="#">위치</label>
								<textarea name="loc" class="form-control" id="loc" cols="30" rows="4" ></textarea>
							</div>
						</div>
						
						<div class="col-md-12">
							<div class="form-group">
								<label class="label" for="#">행사유형</label> 
								<select id="eType" name="eType">
									<option value="">행사유형을 선택해 주세요.</option>
									<option value="E01">결혼식</option>
									<option value="E02">돌잔치</option>
									<option value="E03">개인행사</option>
									<option value="E04">기업행사</option>
									<option value="E05">각종축제</option>
									<option value="E06">기념식</option>
									<option value="E07">가요제</option>
									<option value="E08">플리마켓</option>
									<option value="E09">체육대회</option>
									<option value="E10">단합행사</option>
									<option value="E11">세미나</option>
									<option value="E12">포럼</option>
									<option value="E13">워크샵</option>
									<option value="E14">전시회</option>
									<option value="E15">박람회</option>
									<option value="E00">기타</option>
								</select>
							</div>
						</div>
						
						<div class="col-md-12">
							<div class="form-group">
								<label class="label" for="#">근무시작일</label>
								<input type="date" name="wSday" id="wSday">
							</div>
						</div>
						
						<div class="col-md-12">
							<div class="form-group">
								<label class="label" for="#">근무종료일</label>
								<input type="date" name="wEday" id="wEday">
							</div>
						</div>
						
						<div class="col-md-12">
							<div class="form-group">
								<label class="label" for="#">근무시간</label>
								<input type="number" name="wHour" id="wHour">
							</div>
						</div>
						
						<div class="col-md-12">
							<div class="form-group">
								<label class="label" for="#">자격</label>
								<textarea name="preference" class="form-control" id="preference" cols="30" rows="4" ></textarea>
							</div>
						</div>
						
						<div class="col-md-12">
							<div class="form-group">
								<label class="label" for="#">우대사항</label>
								<textarea name="preference" class="form-control" id="preference" cols="30" rows="4" ></textarea>
							</div>
						</div>
						
						<div class="col-md-12">
							<div class="form-group">
								<label class="label" for="#">마감일</label>
								<input type="date" name="closeDt" id="closeDt">
							</div>
						</div>
						
						<div class="col-md-12">
							<div class="form-group">
								<input type="file" id="imgInp" name="uploadFile" multiple="multiple"/>
								<div class="fileDown">
									<img id="blah" src="#" alt = "your image" width="250px" />
									<button type="button" id="cancel" class="btn btn-warning cancel">
						              <span>Cancel</span>
						          	</button>
								</div>
							</div>
						</div>
						
						<div class="col-md-12">
							<div class="form-group">
								<label class="label" for="#">회원ID</label>
								<input type="text" name="userId" id="userId">
							</div>
						</div>

						<div class="col-md-12">
							<div class="form-group">
								<input type="submit" id="insert" value="등록"
									class="btn btn-primary">
								<div class="submitting"></div>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>

<script>
//csrf 설정
var token = $("meta[name='_csrf']").attr("content");
var header = $("meta[name='_csrf_header']").attr("content");

let oEditors = []

smartEditor = function() {
	console.log("Naver SmartEditor")
	nhn.husky.EZCreator.createInIFrame({
		oAppRef : oEditors,
		elPlaceHolder : "jobCntn",
		sSkinURI : "/smarteditor2/SmartEditor2Skin.html",
		fCreator : "createSEditor2"
	})
}

$(document).ready(function() {
	smartEditor()
})
		
$('#insert').on('click', function insert() {
			 oEditors.getById["jobCntn"].exec("UPDATE_CONTENTS_FIELD", []) //글자스타일 -태그를 db에 저장해줌
			let jobCntn = document.getElementById("jobCntn").value //태그 생성 
			//alert(jobCntn);
			 <!--var data = $('form[name="jobInsert"]').serializeArray();
			//구직테이블 입력처리
			$.ajax({
				url : "/jobInsert", //controller 링크
				method : 'post',
				contentType : 'application/x-www-form-urlencoded',
				data : data,
				success : function(data) {
					if (data == 1){
					alert('등록완료!');
					location.href = '/jobList';
					}else 
						alert('등록실패')
				},
				fail : function(result) {
					alert('필수항목을 입력해주세요')
				}
			}) -->
			
		})
		
	//파일 업로드 이미지 미리보기
	    //파일 INPUT창에 변화가 있을 경우 실행
	    $("#imgInp").on('change', function() {
	    	//파일을 올렸을 경우 input type=file은 사라지고 이미지만 띄어진다.
	    	$(this).toggleClass("fileDown");
	    	//사진부분, <div> 미리 보이게 되면 사진이 없어서 엑박나오니까 없어지게,,
	    	$(this).next().toggleClass("fileDown");
			readURL(this);
		});
		
	    //이미지 미리보기 처리
		function readURL(input){
	    	//input.files(list)의 첫번째 항목
	    	//첨부파일 여러개 넣어도 하나의 사진만 보여줌.
			if(input.files && input.files[0]){
				var reader = new FileReader();
				reader.onload = function(e) {
					$("#blah").attr('src', e.target.result);
				}
				reader.readAsDataURL(input.files[0]);
			}
		}
	    
	    //파일 삭제
	    $("#cancel").on('click', function() {
	    	//파일을 지우고 싶을때 삭제버튼을 누르면 이미지는 사라지고 input type=file 입력폼이 다시 나타난다.
	    	$(this).parent().prev().toggleClass("fileDown");
	    	$(this).parent().toggleClass("fileDown");
	    	//file영역에 있던 값 삭제
	    	$("#imgInp").val('');
	    })				
	</script>
</div>
</html>