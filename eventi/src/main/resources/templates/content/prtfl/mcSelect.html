<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
   xmlns:th="http://www.thymeleaf.org"
   xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
   layout:decorate="~{layouts/default_layout}">

<div layout:fragment="content">

   <section class="hero-wrap hero-wrap-2"
      style="background-image: url(&quot;/images/bg_2.jpg&quot;); background-position: 50% 0%;"
      data-stellar-background-ratio="0.5">
      <div class="overlay"></div>
      <div class="container">
         <div
            class="row no-gutters slider-text align-items-end justify-content-center">
            <div
               class="col-md-9 ftco-animate mb-5 text-center fadeInUp ftco-animated">
               <h2 class="mb-0 bread">사회자 포트폴리오</h2>
            </div>
         </div>
      </div>
   </section>
   
    <table>
      <thead>
         <tr>
            <th>사용자ID</th>   
            <th>한줄소개</th>   
            <th>경력</th>   
         </tr>
      </thead>
      <tbody>
         <tr th:each="mc : ${mcSelect}">
            <td id="userId" th:text=${mc.userId}></td>
            <td th:text=${mc.oneIntro}></td>
            <td th:text=${mc.carrYear}></td>
         </tr>
      </tbody>
   </table>
   
   <!-- <table>
      <thead>
         <tr>
            <th>작성자ID</th>   
            <th>내용</th>   
            <th>작성일자</th>   
         </tr>
      </thead>
      <tbody>
         <tr th:each="mcRey : ${mcReply}">
            <td th:text=${mcRey.userId}></td>
            <td th:text=${mcRey.replyCntn}></td>
            <td th:text=${mcRey.writingDt}></td>
         </tr>
      </tbody>
   </table>
    -->
    
    <div>
    	<div class="pt-5 mt-5" >
          <h3 class="mb-5">6 Comments</h3>
            	<ul class="comment-list" id=reply>
           		</ul>
        </div>
    </div>
   
   <script>
   		let replyTag = $('#userId').text();
   		let p = $("<p>").text('test합니다.');
   		
   		//댓글, 대댓글 불러오는 ajax
   		$.ajax({
   			url : '/prtfl/mcReply',
   			method : 'post',
   			data : JSON.stringify({replyTgt:replyTag}),
   			contentType : "application/json"
   		}).then(res => {
   			for(reply of res){
   				//댓글일 경우
   				if(reply.rerepTgt == null){
   					$("#reply").append(make(reply));
   				} else { //대댓글일 경우
   					$("#" + reply.rerepTgt).append(makeRe(reply));
   				}
   			}
   		})
   		
   		//댓글 tr생성
   		function make(reply){
   			let p = `
                  <li class="comment">
                    <div class="comment-body"  id="${reply.replyNo}">
                      <h3>${reply.userId}</h3>
                      <div class="meta">${reply.writingDt}</div>
                      <p>${reply.replyCntn}</p>
                      <p><a href="#" class="reply">Reply</a></p>
                    </div>
                   </li>
                `
   			return p;
   		}
   		
   		//대댓글 tr생성
   		function makeRe(reply){
   			let p = `<ul class="children">
                <li class="comment">
                <div class="comment-body">
                  <h3>${reply.userId}</h3>
                  <div class="meta">${reply.writingDt}</div>
                  <p>${reply.replyCntn}</p>
                  <p><a href="#" class="reply">Reply</a></p>
                </div>
              </li>
            </ul>`
            
            return p;
   		}
   </script>

</div>

</html>