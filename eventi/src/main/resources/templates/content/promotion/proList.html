<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
   xmlns:th="http://www.thymeleaf.org"
   xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
   layout:decorate="~{layouts/default_layout}">
<head>
 <link rel="stylesheet" href="index.css" />
 <link rel="stylesheet" href="eventi.css" />

<!-- 구글 폰트 아이콘 -->
 <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
<style>
.content-wrap {
     width: 81%;
     margin: 20px auto 0;
}
.option-area,
.card-area {
    padding: 0 16px;
}
.filtering-area {
    margin-bottom: 16px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--light-gray);
}

/* 필터링 영역 */
.filtering-area {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.filteringbox > h2,
.selectbox {
    display: inline-block;
    font-size: 20px;
}
.filteringbox > h2 {
    margin-right: 16px;
    font-weight: normal;
}
.selectbox {
    border: none;
    outline: none;
    font-weight: bold;
    color: var(--main-color);
    cursor: pointer;
}
.select-item {
    font-size: 14px;
    margin: 100px;
    color: #000;
    cursor: pointer;
}
/* 필터링 영역 끝 */

/* 검색, 버튼 영역 */
.search-area {
    display: flex;
    gap: 6px;
}
.searchbox,
.button {
    display: inline-block;
    height: 40px;
    padding: 12px;
    border-radius: 3px;
}
.searchbox {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 300px;
    border: 1px solid var(--light-gray);
}
.searchbox > input {
    width: 100%;
    margin-right: 12px;
    border: none;
    outline: none;
}
.searchbox > input::placeholder {
    color: var(--light-gray);
}
.searchbox > i {
    color: var(--main-color);
    cursor: pointer;
}

.button {
    cursor: pointer;
}
.user-search-button {
    background: #fff;
    border: 1px solid var(--light-gray);
}
.post-button {
    background: var(--main-color);
    border: none;
    color: #fff;
}
/* 검색, 버튼 영역 끝 */

/* 정렬 영역 */
.sorting-area {
    text-align: right;
    margin-bottom: 12px;
}
.sortingbox {
    border: none;
    outline: none;
    font-size: 14px;
    cursor: pointer;
}
/* 정렬 영역 끝 */

/* 카드 영역 */
.card-wrap {
    display: flex;
    gap: 26px;
    flex-wrap: wrap;

}
.card {
    display: inline-block;
    width: 252px;
    height: 380px;
    border-radius: 6px;
    border: 1px solid var(--light-gray);
    cursor: pointer;
    overflow: hidden;
}
.card:last-of-type {
    margin-right: none;
}
.card-image-wrap {
    position: relative;
}
.card-image-wrap > i {
    position: absolute;
    top: 12px;
    right: 12px;
    cursor: pointer;
}
.card-image-wrap {
    height: 230px;
    overflow: hidden;
}
.card-image-wrap > img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.card-info-wrap {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 16px;
    height: calc(380px - 230px);
}
.card-info-wrap > h3 {
    font-weight: bold;
    font-size: 18px;
}
.card-detail-wrap > li {
    font-size: 14px;
}
.card-detail-wrap > li:last-of-type {
    margin-top: 4px;
}
.card-detail-wrap label {
    margin-right: 4px;
    font-weight: bold;
    color: var(--main-color);
}
/* 카드 영역 끝 */
@import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.6/dist/web/static/pretendard-dynamic-subset.css");

:root {
	--main-color: #FAB955;
	--light-gray: #dbdbdb;
}

html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video,
textarea {
	margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
	box-sizing: border-box;
}
a {
	color: inherit;
	text-decoration: none;
}

/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure, 
footer, header, hgroup, menu, nav, section {
	display: block;
}
body * {
	font-family: 'Pretendard';
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}
ol, ul, li {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}
#mid-section{
margin: 0 auto;
    width: 81%;
}
</style>
</head>
<body>

<div layout:fragment="content">
<section id="picture "class="module bg-dark-60 gallery-page-header parallax-bg" 
		data-background="/images/promotion.jpg" style="background-image: url(&quot;assets/images/promotion.jpg&quot;); background-size: 100%;">
          <div class="container">
            <div class="row">
              <div class="col-sm-6 col-sm-offset-3">
                <h2 class="module-title font-alt" style="margin: 0;">홍보게시판</h2>
              </div>
            </div>
          </div>
</section>
	
    <main>
        <div class="content-wrap">
        	<form action="/proList" id="searchForm">
            <div class="option-area">
                <div class="filtering-area">
                    <!-- 필터링 영역 -->
                    <div class="filteringbox">
                        <h2>행사 유형</h2>
					        <select id="etype" name="eType"  onchange="order()">
								<option value="" selected>------</option>
								<option value="E00" th:selected="${promotionVO.eType=='E00'}" >기타</option>
								<option value="E01" th:selected="${promotionVO.eType=='E01'}" >결혼식</option>
								<option value="E02" th:selected="${promotionVO.eType=='E02'}" >돌잔치</option>
								<option value="E03" th:selected="${promotionVO.eType=='E03'}" >개인행사</option>
								<option value="E04" th:selected="${promotionVO.eType=='E04'}" >기업행사</option>
								<option value="E05" th:selected="${promotionVO.eType=='E05'}" >각종축제</option>
								<option value="E06" th:selected="${promotionVO.eType=='E06'}" >기념식</option>
								<option value="E07" th:selected="${promotionVO.eType=='E07'}" >가요제</option>
								<option value="E08" th:selected="${promotionVO.eType=='E08'}" >플리마켓</option>
								<option value="E09" th:selected="${promotionVO.eType=='E09'}" >체육대회</option>
								<option value="E10" th:selected="${promotionVO.eType=='E10'}" >단합행사</option>
								<option value="E11" th:selected="${promotionVO.eType=='E11'}" >세미나</option>
								<option value="E12" th:selected="${promotionVO.eType=='E12'}" >포럼</option>
								<option value="E13" th:selected="${promotionVO.eType=='E13'}" >워크샵</option>
								<option value="E14" th:selected="${promotionVO.eType=='E14'}" >전시회</option>
								<option value="E15" th:selected="${promotionVO.eType=='E15'}" >박람회</option>
								<option value="E00" th:selected="${promotionVO.eType=='E00'}" >기타</option>
							</select> 
                    </div>

                    <!-- 검색, 버튼 영역 -->
                    <div class="search-area">  
                        <div class="searchbox">
                        <input type="text" name="eName" placeholder="검색어를 입력해주세요" th:value="${param.eName}">
						
                            <i class="material-symbols-outlined" id="find" >search</i>
                        </div>
                         <button class="button post-button" type="button" onclick="proInsert()"><i class="fa fa-heart" ></i> 게시글등록</button>
                </div>
               </div>
                <!-- 정렬 영역 -->
                <div class="sorting-area">
					<select class="sortingbox" id="see" name="orderCol" onchange="order()">
						<option value="" th:selected="${#strings.equals(param.orderCol, '')}" >------</option>
						<option value="dt" th:selected="${#strings.equals(param.orderCol, 'dt')}">작성순</option>
						<option value="see"  th:selected="${#strings.equals(param.orderCol, 'see')}">조회수</option>
					</select>
                </div>
            </div>
			</form>
        </div>
    </main>
    
    <div id="mid-section">
		<!-- 전체게시물 -->      
            <div class="row">
              <div class="col-sm-6 col-sm-offset-3">
                <h2 class="module-title font-alt" id="check">전체게시물</h2>
                <div class="module-subtitle font-serif">원하는 유형의 글을 조회하고 참여해보세요.</div>
              </div>
            </div>
            
            <div class="row">
              <div class="mb-sm-20 wow fadeInUp col-sm-6 col-md-3" th:each="pro : ${proList}" onclick="wow fadeInUp" 
              		style="visibility: visible; animation-name: fadeInUp;">
                <div class="team-item" id="check" > 
                  <div class="team-image" th:onclick="|location.href='@{proDetail(proNo=${pro.proNo})}'|">
                         <th:block th:if="${pro.img} == null">
							<div class="post-thumbnail">
								<a href="#"><img th:src="@{/images/hire.jpg}" style="width: 250px; height: 250px; border-radius: 20px; 
												filter: drop-shadow(5px 5px 5px #999); " class="img-fluid" alt="Colorlib Template"></a>
							</div>
						</th:block>
						<th:block th:if="${pro.img} != null">
							<div class="post-thumbnail">
								<a href="#"><img th:src="|/fileView/${pro.img}|" style="width: 250px; height: 250px; border-radius: 20px;
    											filter: drop-shadow(5px 5px 5px #999);" class="img-fluid" alt="Colorlib Template"></a>
							</div>
						</th:block>
                    <div class="team-detail" > 										
                      <h5 class="font-alt" th:text="|작성자: ${pro.userId}|">작성자</h5>
                      <p class="font-serif" th:text=${pro.eType}></p>
                    </div>
                  </div>
                  <div class="team-descr font-alt">
                    <div class="team-role" th:text="|제목:${pro.eName}|">Art Director</div>
                    <div class="team-name" th:text="|조회수:${pro.see}|">조회수</div>
                  </div>
                </div>
              </div>
            </div>
          
       <!-- 인기게시물 -->
		<section class="module sliding-portfolio">
          <div class="row">
            <div class="col-sm-6 col-sm-offset-3">
              <h3 class="module-title font-alt">인기게시물</h3>
            </div>
          </div>
          <div class="container-fluid">
            <div class="row" >
              <div class="owl-carousel text-center" data-items="4" data-pagination="false" data-navigation="false">

                <div class="owl-item" th:each="post : ${contents}">
                  <div class="col-sm-12">
                    <div class="work-item"><a href="#">
                        <div class="work-image" th:onclick="|location.href='@{proDetail(proNo=${post.proNo})}'|">
                        <a href="#" >
                               <th:block th:if="${post.img} == null">
							<div class="post-thumbnail">
								<a href="#"><img th:src="@{/images/hire.jpg}" style="width: 250px; height: 250px border-radius: 20px;
    										filter: drop-shadow(5px 5px 5px #999);" class="img-fluid" alt="Colorlib Template"></a>
							</div>
						</th:block>
						<th:block th:if="${post.img} != null">
							<div class="post-thumbnail">
								<a href="#"><img th:src="|/fileView/${post.img}|" style="width: 250px; height: 250px border-radius: 20px;
    										filter: drop-shadow(5px 5px 5px #999);" class="img-fluid" alt="Colorlib Template"></a>
							</div>
						</th:block>
                        </a></div>
                        <div class="work-caption font-alt">
                          <h3 class="work-title" th:text="|제목:${post.eName}">Corporate Identity</h3>
                          <div class="work-descr" th:text="|조회수:${post.see}|">Illustration</div>
                        </div></a></div>
                  </div>
                </div>             
              </div>
            </div>
          </div>
        </section>
        
          <div class="row mt-5">
		          <div class="col text-center">
		            <div class="block-27">
		               <th:block th:replace="fragments/paging :: component(${paging},'gopage')">
		            </div>
		          </div>
		        </div>
		        
		<!-- 이미지 나타내기 -->	
					<div th:each="f : ${file}">
				       <a><img th:src="|/fileView/${f.sevNm}|" style="width: 250px; height: 250px" class="img-fluid" alt="Colorlib Template"></a>
				   	</div>
         </div>
<script>

//데이터 없을시 이미지 띄우기 
$(document).ready(function () {
	  let result = '[[${result}]]';
	if (result != '') {
		$('#none').empty();
		$('#none').after('<img src="/assets/images/no_data_found.jpg" style="height:30%; width:70%; margin:100px 0px 50px 250px;">')
	}
})

//정렬
function order(){
let etype = $("#etype").val(); //공통으로 씀 
	location.href=`/proList?eType=${etype}`
}

//csrf 설정
var token = $("meta[name='_csrf']").attr("content");
var header = $("meta[name='_csrf_header']").attr("content");


link1 = 'proInsert'; //구인등록폼 이동
function proInsert(){
	location.href = link1;
}
//페이징
function gopage(i) {
    console.log(i);
    location.href = `/proList?page=${i}&orderCol=${document.querySelector("#see").value}&eName=${$("input[name=eName]").val()}`;
}
//정렬
	function order(){
		let param = $("#searchForm").serialize()
		location.href=`/proList?${param}`
	}

//검색기능
	$('#find').click(function() {
		gopage(1);
		//입력한 값 가져오기
		/* let search = $("input[name=eName]").val();
		
		$.ajax({
			url : '/proList',
			method : 'post',
			data : {eName:search}, //title = search(title변수안에 data)
			beforeSend : function(xhr)
	        {  
				xhr.setRequestHeader(header, token);
	        }
		}).then(res => {
			//tbody밑에 있는 데이터 지우기
			
			$("#check").empty();
			
			//tbody에 들어갈 tr 생성
			for(r of res){ //제목, 내용 검색 시
				//if(r.title.includes(search) || r.jobCntn.includes(search)){
					//alert(r.loc)
					$("#check").append(makeTr(r));
	   			//}
			}
		})
			
		$("input[name=eName]").val(''); */
	})
		
		
	//tr 생성 함수
	function makeTr(r){
	console.log(r)
	let tr = `<tr onclick="location.href='/proDetail?proNo=${r.proNo}'">
					<td>${r.proNo}</td>
					<td>${r.eName}</td>
		 			<td>${r.etype}</td> 
					<td>${r.userId}</td>
			  </tr>`
	return tr;		
}	
	
	
</script>	
</div>
</body>
</html>